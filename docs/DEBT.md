# æŠ€æœ¯å€ºåŠ¡æ¸…å•

æœ¬æ–‡æ¡£è®°å½•é¡¹ç›®ä¸­éœ€è¦å¤„ç†çš„å†—ä½™ã€è¿‡æœŸä»£ç å’Œæ¶æ„é—®é¢˜ã€‚

## 1. å†—ä½™ä»£ç  (éœ€è¦æ¸…ç†)

### 1.1 é‡å¤çš„å·¥å…·å‡½æ•° (âœ“ å·²å®Œæˆ)

| æ–‡ä»¶       | packages/util/ | packages/ccode/util/ | çŠ¶æ€               |
| ---------- | -------------- | -------------------- | ------------------ |
| `fn.ts`    | å­˜åœ¨           | Re-export            | âœ“ å·²ç»Ÿä¸€           |
| `iife.ts`  | å­˜åœ¨           | Re-export            | âœ“ å·²ç»Ÿä¸€           |
| `lazy.ts`  | å­˜åœ¨           | Re-export            | âœ“ å·²ç»Ÿä¸€           |

**è§£å†³æ–¹æ¡ˆ (å·²å®æ–½)**:
1. `packages/ccode/src/util/fn.ts` - æ”¹ä¸ºä» `@codecoder-ai/util/fn` re-export
2. `packages/ccode/src/util/iife.ts` - æ”¹ä¸ºä» `@codecoder-ai/util/iife` re-export
3. `packages/ccode/src/util/lazy.ts` - æ”¹ä¸ºä» `@codecoder-ai/util/lazy` re-export
4. æµ‹è¯•æ–‡ä»¶å·²æ›´æ–°ä¸ºç›´æ¥ä½¿ç”¨ `@codecoder-ai/util/`

### 1.2 ccode/util ç‹¬æœ‰æ–‡ä»¶ (ä¿ç•™åœ¨ ccode)

ä»¥ä¸‹æ–‡ä»¶ä»…å­˜åœ¨äº `ccode/util`ï¼Œæ˜¯ç‰¹å®šåŠŸèƒ½ï¼Œåº”ä¿ç•™:

- `archive.ts` - å½’æ¡£å·¥å…·
- `color.ts` - é¢œè‰²å¤„ç†
- `context.ts` - ä¸Šä¸‹æ–‡ç®¡ç†
- `defer.ts` - å»¶è¿Ÿæ‰§è¡Œ
- `eventloop.ts` - äº‹ä»¶å¾ªç¯å·¥å…·
- `filesystem.ts` - æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
- `format.ts` - æ ¼å¼åŒ–å·¥å…·
- `keybind.ts` - é”®ç›˜ç»‘å®š
- `locale.ts` - æœ¬åœ°åŒ–
- `lock.ts` - é”æœºåˆ¶
- `log.ts` - æ—¥å¿—å·¥å…·
- `queue.ts` - é˜Ÿåˆ—å®ç°
- `rpc.ts` - RPC é€šä¿¡
- `scrap.ts` - æŠ“å–å·¥å…·
- `security.ts` - å®‰å…¨å·¥å…·
- `signal.ts` - ä¿¡å·å¤„ç†
- `timeout.ts` - è¶…æ—¶å¤„ç†
- `token.ts` - Token å¤„ç†
- `wildcard.ts` - é€šé…ç¬¦åŒ¹é…

## 2. è¿‡æ—¶çš„æµ‹è¯• (éœ€è¦å®¡æŸ¥)

### 2.1 å¾…æ¸…ç†çš„æµ‹è¯•æ–‡ä»¶

- `packages/ccode/test/snapshot/snapshot.test.ts` - å¿«ç…§æµ‹è¯•éœ€è¦å®¡æŸ¥
- `packages/ccode/test/skill/skill.test.ts` - Skill ç³»ç»Ÿæµ‹è¯•éœ€è¦æ›´æ–°

### 2.2 æµ‹è¯•ä¸­çš„è·³è¿‡æ ‡è®°

éœ€è¦æ£€æŸ¥ä»¥ä¸‹æ ‡è®°å¹¶å¤„ç†:
```bash
grep -r "skip\|pending\|todo" packages/ccode/test/ --include="*.ts"
```

## 3. å¯¼å…¥è·¯å¾„ä¸ä¸€è‡´

### 3.1 é—®é¢˜

é¡¹ç›®ä¸­æ··ç”¨ä¸‰ç§å¯¼å…¥è·¯å¾„æ–¹å¼:
1. `@codecoder-ai/util/` - workspace åŒ… (æ¨è)
2. `@/util/` - åˆ«å (å†…éƒ¨ä½¿ç”¨)
3. `../util/` - ç›¸å¯¹è·¯å¾„ (ä¸æ¨è)

### 3.2 æ ‡å‡†åŒ–ç›®æ ‡

- å·¥å…·å‡½æ•°: `@codecoder-ai/util/xxx`
- é¡¹ç›®å†…éƒ¨: `@/path/to/module`
- é¿å…å¤šçº§ç›¸å¯¹è·¯å¾„ `../../util`

## 4. æ¶æ„ç®€åŒ–é—ç•™

### 4.1 ACP (Agent Client Protocol) å¼•ç”¨

- **çŠ¶æ€**: å·²ç§»é™¤ ACPï¼Œé‡‡ç”¨ç›´æ¥ API æ¶æ„
- **å¾…åŠ**: æ£€æŸ¥æ–‡æ¡£ä¸­æ˜¯å¦è¿˜æœ‰ ACP ç›¸å…³å¼•ç”¨å¹¶æ›´æ–°

### 4.2 packages/sdk/ å¼•ç”¨ (âœ“ å·²å®Œæˆ)

- **çŠ¶æ€**: SDK å·²åˆå¹¶åˆ°ä¸»åŒ…ï¼Œä½¿ç”¨æœ¬åœ°ç±»å‹å®šä¹‰
- **è§£å†³æ–¹æ¡ˆ (å·²å®æ–½)**: 2026-02-05 å·²åˆ é™¤ `packages/sdk/` ç›®å½•å’Œ `script/generate.ts` è„šæœ¬ï¼Œæ›´æ–° AGENTS.md æ–‡æ¡£

## 5. å¾…æ¸…ç†çš„ä¾èµ–

### 5.1 @ai-sdk/* ä¾èµ–å®¡æŸ¥ (âœ“ å·²å®Œæˆ)

**ç»“æœ**: æ‰€æœ‰ 19 ä¸ª @ai-sdk/* åŒ…éƒ½åœ¨è¢«ä½¿ç”¨ã€‚

### 5.2 æœªä½¿ç”¨çš„ devDependencies (âœ“ å·²å®Œæˆ)

**å‘ç°ä»¥ä¸‹æœªä½¿ç”¨çš„ä¾èµ–**:
- `@octokit/webhooks-types` - ä»…åœ¨ package.json ä¸­ï¼Œä»£ç ä¸­æœªä½¿ç”¨
- `@octokit/graphql` - ä»…åœ¨ package.json ä¸­ï¼Œä»£ç ä¸­æœªä½¿ç”¨

**è§£å†³æ–¹æ¡ˆ (å·²å®æ–½)**: 2026-02-05 å·²ä» package.json ä¸­åˆ é™¤è¿™ä¸¤ä¸ªä¾èµ–ã€‚

## 6. æ–‡æ¡£é—®é¢˜

### 6.1 éœ€è¦é‡å†™çš„æ–‡æ¡£ (âœ“ å·²å®Œæˆ)

- `docs/Skills è¿›é˜¶å…¨æ™¯å›¾.md` - âœ“ å·²é‡å†™ä¸ºæŠ€æœ¯æ–‡æ¡£

### 6.2 ç¼ºå¤±çš„æ–‡æ¡£ (âœ“ å·²å®Œæˆ)

- `docs/guides/testing.md` - âœ“ æµ‹è¯•æŒ‡å—å·²åˆ›å»º
- `docs/CODEBASE.md` - âœ“ ä»£ç å¯¼èˆªæ–‡æ¡£å·²åˆ›å»º

## 7. ä»£ç è´¨é‡é—®é¢˜

### 7.1 TypeScript ä¸¥æ ¼æ¨¡å¼

æ£€æŸ¥æ˜¯å¦å¯ä»¥å¯ç”¨æ›´ä¸¥æ ¼çš„ TypeScript é…ç½®:
- `strictNullChecks`
- `noImplicitAny`
- `strictFunctionTypes`

### 7.2 æµ‹è¯•è¦†ç›–ç‡

å½“å‰æµ‹è¯•è¦†ç›–æƒ…å†µ:
- E2E: 21 ä¸ªæ–‡ä»¶
- Unit: 33 ä¸ªæ–‡ä»¶
- Integration: 18 ä¸ªæ–‡ä»¶
- Performance: 4 ä¸ªæ–‡ä»¶
- A11Y: 2 ä¸ªæ–‡ä»¶

**ç›®æ ‡**: ä¿æŒ 80%+ è¦†ç›–ç‡

### 7.3 TypeScript ç±»å‹é”™è¯¯

**çŠ¶æ€**: éƒ¨åˆ†å®Œæˆ (2026-02-04)

**å·²ä¿®å¤**:
- `test/helpers/visual-helper.ts` - tolerance undefined é—®é¢˜
- `test/helpers/e2e-helper.ts` - getOutput() this ç±»å‹é—®é¢˜
- `test/helpers/fixtures/messages.ts` - æ·»åŠ  Message æ¥å£å®šä¹‰
- `test/helpers/fixtures/sessions.ts` - æ·»åŠ  Session å’Œ Message æ¥å£å®šä¹‰
- `test/integration/tui/edge-cases.test.tsx` - Map.keys() undefined å’Œ isEmpty é—®é¢˜

**å‰©ä½™**: çº¦ 100+ ä¸ªæµ‹è¯•æ–‡ä»¶ä¸­çš„ç±»å‹é”™è¯¯ï¼ˆä¸»è¦æ˜¯ TUI é›†æˆæµ‹è¯•ï¼‰

**å»ºè®®**: è¿™äº›é”™è¯¯ä¸å½±å“æ ¸å¿ƒåŠŸèƒ½å’Œæµ‹è¯•è¿è¡Œï¼Œå¯ä»¥åç»­é€æ­¥ä¿®å¤ã€‚

## 8. æ–°å¢æŠ€æœ¯å€ºåŠ¡ (2026-02-16)

### 8.1 BookExpander Zod å…¼å®¹æ€§é—®é¢˜

- **çŠ¶æ€**: ğŸš§ å¾…è§£å†³
- **é—®é¢˜**: Zod v4 + Bun çš„ escapeRegex é”™è¯¯
- **å½±å“**: BookExpander æ¨¡å—æ— æ³•æ­£å¸¸è¿è¡Œ
- **æ–‡æ¡£**: `docs/progress/2026-02-13-bookexpander-implementation.md`

### 8.2 CodeCoder + ZeroBot ç±»å‹å…±äº«

- **çŠ¶æ€**: ğŸš§ å¾…è§„åˆ’
- **é—®é¢˜**: Rust å’Œ TypeScript ä¹‹é—´ç¼ºä¹ç±»å‹åŒæ­¥æœºåˆ¶
- **å½±å“**: æ‰‹åŠ¨ç»´æŠ¤ä¸¤ç«¯ç±»å‹å®šä¹‰ï¼Œå®¹æ˜“ä¸ä¸€è‡´
- **ä½ç½®**: `services/zero-bot/` å’Œ `packages/ccode/src/memory-zerobot/`

### 8.3 å­˜å‚¨è·¯å¾„è¿ç§»åæ¸…ç†

- **çŠ¶æ€**: âœ… å·²å®Œæˆ
- **å†…å®¹**: è·¯å¾„ä» `~/.zero-bot` è¿ç§»åˆ° `~/.codecoder`
- **åç»­**: ç”¨æˆ·éœ€æ‰‹åŠ¨æ‰§è¡Œ `mv ~/.zero-bot/* ~/.codecoder/`
- **æ–‡æ¡£**: `docs/reports/completed/2026-02-16-storage-path-migration.md`

## ä¼˜å…ˆçº§

| ä¼˜å…ˆçº§ | ä»»åŠ¡                          | çŠ¶æ€            | é¢„è®¡å·¥ä½œé‡ |
| ------ | ----------------------------- | --------------- | ---------- |
| é«˜     | ç»Ÿä¸€å·¥å…·å‡½æ•°åˆ° packages/util  | âœ“ å·²å®Œæˆ        | 2å°æ—¶      |
| é«˜     | æ ‡å‡†åŒ–å¯¼å…¥è·¯å¾„                | éƒ¨åˆ†å®Œæˆ        | 3å°æ—¶      |
| é«˜     | BookExpander Zod å…¼å®¹æ€§       | ğŸ†• å¾…è§£å†³       | 2å°æ—¶      |
| ä¸­     | æ¸…ç†è¿‡æ—¶æµ‹è¯•                  | âœ“ å·²éªŒè¯æœ‰æ•ˆ    | 1å°æ—¶      |
| ä¸­     | é‡å†™ Skills æ–‡æ¡£              | âœ“ å·²å®Œæˆ        | 1å°æ—¶      |
| ä¸­     | ZeroBot ç±»å‹å…±äº«              | ğŸ†• å¾…è§„åˆ’       | 4å°æ—¶      |
| ä½     | å®¡æŸ¥ä¾èµ–                      | âœ“ å·²å®Œæˆ        | 1å°æ—¶      |
| ä½     | ä¿®å¤ TS ç±»å‹é”™è¯¯              | éƒ¨åˆ†å®Œæˆ        | 4å°æ—¶      |

## æ›´æ–°è®°å½•

- 2026-02-04: åˆå§‹ç‰ˆæœ¬ï¼Œè®°å½•é‡å¤ä»£ç å’Œæ¶æ„é—®é¢˜
- 2026-02-04: å®Œæˆå·¥å…·å‡½æ•°ç»Ÿä¸€ï¼Œå®Œæˆæ–‡æ¡£æ›´æ–° (progress, CODEBASE, DEBT, testing, Skills)
- 2026-02-04: æ¸…ç†è¿‡æ—¶æµ‹è¯•ï¼ˆéªŒè¯æœ‰æ•ˆï¼‰ï¼Œå®¡æŸ¥ä¾èµ–ï¼ˆå‘ç° 2 ä¸ªæœªä½¿ç”¨ï¼‰ï¼Œä¿®å¤éƒ¨åˆ† TS ç±»å‹é”™è¯¯
- 2026-02-05: æ–‡æ¡£ç»“æ„è§„èŒƒåŒ–ï¼Œåˆ é™¤åºŸå¼ƒæ–‡ä»¶ (script/generate.ts, script/duplicate-pr.ts, packages/sdk/)ï¼Œæ¸…ç†æœªä½¿ç”¨ä¾èµ– (@octokit/*)
- 2026-02-05: åˆ›å»ºä»£ç æ¸…ç†è®¡åˆ’æ–‡æ¡£ ([2026-02-05-code-cleanup.md](progress/2026-02-05-code-cleanup.md))ï¼Œè®°å½•æµ‹è¯•é”™è¯¯å’Œ console.log æ¸…ç†ä»»åŠ¡
- 2026-02-05: âœ… ä¿®å¤ TUI UI æµ‹è¯•ç±»å‹é”™è¯¯ (dialog-alert, dialog-confirm, dialog-prompt, link, toast, transcript)
- 2026-02-05: âœ… ä¿®å¤ 5 ä¸ªå¤±è´¥æµ‹è¯• (provider source ç±»å‹é”™è¯¯å’Œ defaultAgent æµ‹è¯•)
- 2026-02-05: âœ… console.log æ¸…ç† - ç¡®è®¤æ‰€æœ‰ä½¿ç”¨éƒ½åœ¨é€‚å½“çš„ CLI å‘½ä»¤ä¸­
- 2026-02-05: âœ… æ–‡æ¡£æ•´ç†å®Œæˆ - ç§»åŠ¨å·²å®Œæˆæ–‡æ¡£ï¼Œåˆ›å»ºè®°å¿†ç³»ç»Ÿæ¶æ„æ–‡æ¡£ï¼Œæ›´æ–°ç´¢å¼•é“¾æ¥ ([2026-02-05-doc-reorg.md](progress/2026-02-05-doc-reorg.md))
- 2026-02-16: æ·»åŠ æ–°æŠ€æœ¯å€ºåŠ¡ - BookExpander Zod å…¼å®¹æ€§é—®é¢˜ã€ZeroBot ç±»å‹å…±äº«ï¼›æ–‡æ¡£å½’æ¡£æ•´ç†ï¼ˆ11ä¸ªæ–‡æ¡£ä» progress ç§»è‡³ completedï¼‰
- 2026-02-16: å®Œæˆå­˜å‚¨è·¯å¾„è¿ç§»ï¼›æ›´æ–°æŠ€æœ¯å€ºåŠ¡åˆ—è¡¨ï¼›è§„èŒƒåŒ–æŠ¥å‘Šæ–‡ä»¶å‘½å
