# Phase 2.1 æŠ€æœ¯å¯è¡Œæ€§è¯„ä¼° API å®ç°æŠ¥å‘Š

**å®Œæˆæ—¥æœŸ**: 2026-02-22
**çŠ¶æ€**: âœ… å·²å®Œæˆ

---

## å®ç°æ¦‚è¿°

æ ¹æ® `docs/standards/goals.md` çš„äº§å“æ„¿æ™¯ï¼Œå®ç°äº†æŠ€æœ¯å¯è¡Œæ€§è¯„ä¼° APIï¼Œæ”¯æŒä»¥ä¸‹åœºæ™¯ï¼š

> PM åœ¨ç½‘é¡µç«¯å‘ç³»ç»Ÿæé—®ï¼š"æˆ‘ä»¬è¦å¢åŠ ä¸€ä¸ª'å¾®ä¿¡æ‰«ç ç™»å½•'ï¼ŒæŠ€æœ¯å¤æ‚åº¦é«˜å—ï¼Ÿ"
> CodeCoder æ‰«æä»£ç åº“åè¿”å›ç»“è®ºï¼š"ç›®å‰å·²å­˜åœ¨ Auth æ¨¡å—å’Œ OAuth2.0 åŸºç¡€æ¡†æ¶ï¼ˆè€—æ—¶é¢„ä¼°ï¼šä½é£é™©ï¼Œçº¦éœ€æ”¹åŠ¨ 3 ä¸ªæ–‡ä»¶ï¼‰"

## æ–°å¢æ–‡ä»¶

### TypeScript (packages/ccode)

| æ–‡ä»¶ | ç”¨é€” |
|------|------|
| `src/api/server/handlers/assess.ts` | æŠ€æœ¯è¯„ä¼° API å¤„ç†å™¨ |
| `src/agent/prompt/feasibility-assess.txt` | è¯„ä¼°åˆ†ææç¤ºè¯æ¨¡æ¿ |
| `test/api/assess.test.ts` | API å•å…ƒæµ‹è¯• (16 ä¸ªæµ‹è¯•ç”¨ä¾‹) |

### Rust (services/zero-channels)

| æ–‡ä»¶ | ä¿®æ”¹è¯´æ˜ |
|------|----------|
| `src/bridge.rs` | æ–°å¢å¯è¡Œæ€§é—®é¢˜æ£€æµ‹å’Œè·¯ç”±é€»è¾‘ |

## API è®¾è®¡

### POST /api/v1/assess/feasibility

**è¯·æ±‚ä½“**:
```json
{
  "query": "å¢åŠ å¾®ä¿¡æ‰«ç ç™»å½•åŠŸèƒ½ï¼Œå¤æ‚åº¦é«˜å—ï¼Ÿ",
  "options": {
    "depth": "standard",
    "include_code_refs": true,
    "language": "zh-CN"
  }
}
```

**å“åº”ä½“**:
```json
{
  "success": true,
  "data": {
    "summary": "ä½é£é™©ï¼Œé¢„è®¡æ”¹åŠ¨ 3 ä¸ªæ–‡ä»¶",
    "complexity": "low",
    "analysis": {
      "existing_capabilities": [...],
      "required_changes": [...],
      "dependencies": [...],
      "risks": [...]
    },
    "confidence": 0.85
  }
}
```

### GET /api/v1/assess/health

å¥åº·æ£€æŸ¥æ¥å£ï¼Œè¿”å›è¯­ä¹‰å›¾çŠ¶æ€ã€‚

## IM æ¸ é“é›†æˆ

### è‡ªåŠ¨é—®é¢˜æ£€æµ‹

`CodeCoderBridge` ç°åœ¨å¯ä»¥è‡ªåŠ¨æ£€æµ‹æŠ€æœ¯å¯è¡Œæ€§é—®é¢˜ï¼Œæ”¯æŒï¼š

**ä¸­æ–‡æ¨¡å¼**:
- "æŠ€æœ¯å¤æ‚åº¦é«˜å—"
- "èƒ½å®ç°å—"
- "éœ€è¦æ”¹åŠ¨å¤šå°‘æ–‡ä»¶"
- "å¯è¡Œæ€§å¦‚ä½•"
- "é£é™©é«˜å—"

**è‹±æ–‡æ¨¡å¼**:
- "How complex is..."
- "Is it feasible..."
- "Can we implement..."
- "How much work..."

### æ ¼å¼åŒ–è¾“å‡º

IM æ¸ é“æ”¶åˆ°çš„è¯„ä¼°ç»“æœä¼šè‡ªåŠ¨æ ¼å¼åŒ–ä¸ºå¯è¯»æ ¼å¼ï¼š

```
ğŸ“Š **æŠ€æœ¯å¯è¡Œæ€§è¯„ä¼°**

**éœ€æ±‚**: å¢åŠ å¾®ä¿¡ç™»å½•åŠŸèƒ½
**å¤æ‚åº¦**: ğŸŸ¢ ä½

âœ… **ç°æœ‰èƒ½åŠ›**
â€¢ Authæ¨¡å— (src/auth/)

ğŸ“ **éœ€è¦ä¿®æ”¹**
[æ–°å»º] src/auth/wechat.ts
[ä¿®æ”¹] src/auth/config.ts

ğŸ“¦ **æ–°å¢ä¾èµ–**
â€¢ wechat-oauth (npm)

âš ï¸ **é£é™©æç¤º**
â€¢ éœ€è¦ç”³è¯·å¾®ä¿¡å¼€æ”¾å¹³å°

ç½®ä¿¡åº¦: 85%
```

## æµ‹è¯•è¦†ç›–

### TypeScript æµ‹è¯•
- è¯·æ±‚éªŒè¯ (4 ä¸ªç”¨ä¾‹)
- å“åº” Schema éªŒè¯ (4 ä¸ªç”¨ä¾‹)
- æ¸ é“æ ¼å¼åŒ– (4 ä¸ªç”¨ä¾‹)
- å¤æ‚åº¦æ ‡ç­¾ (4 ä¸ªç”¨ä¾‹)

### Rust æµ‹è¯•
- ä¸­æ–‡é—®é¢˜æ£€æµ‹ (3 ä¸ªæ–­è¨€)
- è‹±æ–‡é—®é¢˜æ£€æµ‹ (2 ä¸ªæ–­è¨€)
- è¯·æ±‚åºåˆ—åŒ–
- å“åº”ååºåˆ—åŒ–
- æ ¼å¼åŒ–è¾“å‡º

## æ¶æ„æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IM Channel     â”‚  (é£ä¹¦/ä¼ä¸šå¾®ä¿¡/Telegram)
â”‚  (zero-channels)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ is_feasibility_question() æ£€æµ‹
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CodeCoderBridgeâ”‚  è‡ªåŠ¨è·¯ç”±
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ POST /api/v1/assess/feasibility
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  CodeCoder API  â”‚  (port 4400)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ è°ƒç”¨ @general agent + SemanticGraph
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ ¼å¼åŒ–è¾“å‡º     â”‚  è½¬æ¢ä¸º IM å‹å¥½æ ¼å¼
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## åç»­å·¥ä½œ

- [ ] Phase 1: ä¼ä¸šå¾®ä¿¡/é’‰é’‰é›†æˆ
- [ ] Phase 2.2: Code Review é€šçŸ¥é—­ç¯
- [ ] Phase 2.3: PRD æ¨¡æ¿è‡ªåŠ¨è¡¥å…¨

## éªŒè¯æ–¹å¼

```bash
# API æµ‹è¯•
curl -X POST http://localhost:4400/api/v1/assess/feasibility \
  -H "Content-Type: application/json" \
  -d '{"query": "å¢åŠ å¾®ä¿¡æ”¯ä»˜åŠŸèƒ½ï¼Œå¤æ‚åº¦é«˜å—ï¼Ÿ"}'

# å¥åº·æ£€æŸ¥
curl http://localhost:4400/api/v1/assess/health
```
