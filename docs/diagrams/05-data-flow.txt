+--------------------------------------------------------------------------------------+ +---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+ +--------------------------------------------------------------------------------------+
|                                 "üì• Input Sources"                                   | |                                                             "‚öôÔ∏è Configuration"                                                              |                                                "üß† Memory System"                                                                                                                                                                                               | |                                     "üì§ Output"                                      |
|                                                                                      | |                                                                                                                                             |                                                                                                                                                                                                                                                                 | |                                                                                      |
|                                                                                      | |                                                                                                                                             |                                                                                                                                                                                                                                                                 | |                                                                                      |
| +--------------+     +--------------------+     +----------------------------------+ | | +----------------------------+     +---------------------+     +-------------------------+     +-----------------+     +------------------+ |   +-------------+     +--------------+     +------------------+     +-----------------+     +----------------------------+     +-----------------------+     +------------------------------+     +----------------+     +------------------------------------+ | | +---------------+     +----------------+     +----------------+     +--------------+ |
| |              |     |                    |     |                                  | | | |                            |     |                     |     |                         |     |                 |     |                  | |   |             |     |              |     |                  |     |                 |     |                            |     |                       |     |                              |     |                |     |                                    | | | |               |     |                |     |                |     |              | |
| | "User Input" |  +--| "File Attachments" |  +--|        "MCP Tool Results"        | |+--| "~/.codecoder/codecoder.jsonc" |  +--| "./codecoder.jsonc" |  +--| "Environment Variables" |  +--| "rules/**/*.md" |  +--| "agents/**/*.md" | |   | "MessageV2[ |     | "Agent.Info" |     | "Provider.Model" |     | "Tool Registry" |     | "Session Store<br/>(JSON)" |     | "_backup/<br/>(Auto)" |     | "_corrupted/<br/>(Isolated)" |     | "Health Check" |  +--| "daily/{date}.md<br/>(Flow Layer)" | | | | "TUI Display" |     | "File Changes" |     | "API Response" |     | "SSE Events" | |
| |              |  |  |                    |  |  |                                  | ||| |                            |  |  |                     |  |  |                         |  |  |                 |  |  |                  | |   |             |     |              |     |                  |     |                 |     |                            |     |                       |     |                              |     |                |  |  |                                    | | | |               |     |                |     |                |     |              | |
| +--------------+  |  +--------------------+  |  +----------------------------------+ ||| +----------------------------+  |  +---------------------+  |  +-------------------------+  |  +-----------------+  |  +------------------+ |   +-------------+     +--------------+     +------------------+     +-----------------+     +----------------------------+     +-----------------------+     +------------------------------+     +----------------+  |  +------------------------------------+ | | +---------------+     +----------------+     +----------------+     +--------------+ |
|         |         |                          |                                       |||                                 |                           |                               |                       |                       |                                                                                                                                            ^                                 ^                             ^          |                                         | |         |                      |                      |                     |        |
+---------|---------|--------------------------|---------------------------------------+||---------------------------------|---------------------------|-------------------------------|-----------------------|-----------------------+                                                                                                                                            |                                 |                             |          |                                         | +---------|----------------------|----------------------|---------------------|--------+
          +---------+-------------+------------+--------------------+-------------------+----------------------------------+---------------------------+-------------------------------+-----------------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+                                         |           |                      |                      |                     |         
          |         |             |                                 |                   ||                                                                                                                                                                                                                                                                                          |                                 |                             |                                                    |           |                      |                      |                     |         
          v         |             v                                 v                   ||                                                                                                                                                                                                                                                                                          |                                 |                             |                                                    |           |                      |                      |                     |         
  +--------------+  |  +--------------------+     +----------------------------------+  || +----------------------------+                                                                                                                                                                                                                                                           |                                 |                             |                                                    |           |                      |                      |                     |         
  |              |  |  |                    |     |                                  |  || |                            |                                                                                                                                                                                                                                                           |                                 |                             |                                                    |           |                      |                      |                     |         
  |   Session    |<-+--|       Config       |     | "MEMORY.md<br/>(Sediment Layer)" |  +->|           Output           |<-------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------------------------+---------------------------------+-----------------------------+----------------------------------------------------------------+----------------------+----------------------+---------------------+         
  |              |  |  |                    |     |                                  |   | |                            |                                                                                                                                |                                                                                                                                                                                                                                               |                                                                                         
  +--------------+  |  +--------------------+     +----------------------------------+   | +----------------------------+                                 +----------------------------------------------------------------------------------------------+                                                                                                                                                                                                                                               |                                                                                         
          |         |                                                                    |                                                                |                                                                                                                                                                                                                                                                                                                                              |                                                                                         
          |         |                                                                    +----------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+                                                                                         
          |         +-------------+-----------------------------------------------------------------------------------------------------------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                        
          |         |             |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
          v         |             v                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                
  +--------------+  |  +--------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  |              |  |  |                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  |   Storage    |--+  |       Memory       |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  |              |     |                    |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
  +--------------+     +--------------------+                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      
